<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office Ultimate Hub - C√¥ng c·ª• VƒÉn ph√≤ng ƒêa nƒÉng</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --bg: #f8fafc;
            --sidebar: #1e293b;
            --text: #334155;
            --success: #22c55e;
            --danger: #ef4444;
        }
        * { box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { display: flex; margin: 0; background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; }
        
        /* Sidebar */
        .sidebar { width: 260px; background: var(--sidebar); color: white; padding: 20px; display: flex; flex-direction: column; overflow-y: auto; }
        .sidebar h2 { font-size: 1.1rem; margin-bottom: 25px; color: #60a5fa; text-align: center; border-bottom: 1px solid #334155; padding-bottom: 15px; }
        .menu-group { margin-bottom: 15px; }
        .menu-label { font-size: 0.7rem; color: #64748b; text-transform: uppercase; margin-bottom: 8px; padding-left: 10px; display: block; }
        .menu-btn { 
            width: 100%; background: none; border: none; color: #94a3b8; padding: 10px 15px; text-align: left; 
            cursor: pointer; font-size: 0.9rem; border-radius: 8px; margin-bottom: 2px; transition: 0.2s;
        }
        .menu-btn:hover, .menu-btn.active { background: #334155; color: white; }

        /* Main Content */
        .main { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; }
        .tool-card { background: white; padding: 30px; border-radius: 16px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); display: none; width: 100%; max-width: 800px; }
        .tool-card.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h3 { margin-top: 0; color: var(--sidebar); border-left: 4px solid var(--primary); padding-left: 10px; margin-bottom: 20px; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #e2e8f0; border-radius: 10px; font-size: 1rem; outline: none; }
        input:focus, select:focus { border-color: var(--primary); }
        button { background: var(--primary); color: white; border: none; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: 600; }
        button:hover { filter: brightness(1.1); }

        /* Custom UI */
        .result-box { background: #f0f7ff; padding: 15px; border-radius: 10px; margin-top: 15px; border: 1px solid #dbeafe; min-height: 50px; color: #1e40af; font-weight: 500; }
        .todo-item { display: flex; align-items: center; background: #f8fafc; padding: 10px; margin-bottom: 5px; border-radius: 8px; }
        .timer-display { font-size: 4rem; font-weight: bold; text-align: center; margin: 20px 0; color: var(--sidebar); }
        .flashcard-inner { width: 100%; height: 200px; cursor: pointer; perspective: 1000px; margin: 15px 0; }
        .card-body { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; }
        .card-body.flipped { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; border-radius: 15px; font-size: 1.2rem; padding: 20px; border: 1px solid #e2e8f0; background: #fff; }
        .card-back { transform: rotateY(180deg); background: #fefce8; color: #854d0e; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>OFFICE HUB 2025</h2>
        
        <div class="menu-group">
            <span class="menu-label">C√° nh√¢n & NƒÉng su·∫•t</span>
            <button class="menu-btn active" onclick="showTool('todo', this)">üìù To-do & Excel</button>
            <button class="menu-btn" onclick="showTool('pomodoro', this)">‚è±Ô∏è Pomodoro</button>
            <button class="menu-btn" onclick="showTool('notes', this)">üìì Ghi ch√∫ nhanh</button>
            <button class="menu-btn" onclick="showTool('flashcards', this)">üìá Flashcards</button>
        </div>

        <div class="menu-group">
            <span class="menu-label">T√†i ch√≠nh & C√¥ng c·ª•</span>
            <button class="menu-btn" onclick="showTool('currency', this)">üí± ƒê·ªïi ngo·∫°i t·ªá</button>
            <button class="menu-btn" onclick="showTool('numToWord', this)">üí∞ S·ªë th√†nh Ch·ªØ</button>
            <button class="menu-btn" onclick="showTool('calc', this)">üßÆ M√°y t√≠nh %</button>
        </div>

        <div class="menu-group">
            <span class="menu-label">Ti·ªán √≠ch h·ªá th·ªëng</span>
            <button class="menu-btn" onclick="showTool('age', this)">üéÇ T√≠nh tu·ªïi</button>
            <button class="menu-btn" onclick="showTool('link', this)">üîó R√∫t g·ªçn link</button>
        </div>
    </div>

    <div class="main">
        <section id="currency" class="tool-card">
            <h3>Chuy·ªÉn ƒë·ªïi ngo·∫°i t·ªá (T·ª∑ gi√° Real-time)</h3>
            <label>S·ªë ti·ªÅn:</label>
            <input type="number" id="currAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn..." oninput="convertCurrency()">
            <label>ƒê∆°n v·ªã ngu·ªìn:</label>
            <select id="currFrom" onchange="convertCurrency()">
                <option value="USD">USD - ƒê√¥ la M·ªπ</option>
                <option value="EUR">EUR - Euro</option>
                <option value="CNY">CNY - Nh√¢n d√¢n t·ªá (Trung Qu·ªëc)</option>
                <option value="KRW">KRW - Won (H√†n Qu·ªëc)</option>
            </select>
            <div class="result-box" id="currResult">K·∫øt qu·∫£: 0 VND</div>
            <p style="font-size: 0.8rem; color: #94a3b8; margin-top: 10px;">* H·ªá th·ªëng t·ª± ƒë·ªông c·∫≠p nh·∫≠t t·ª∑ gi√° t·ª´ ng√¢n h√†ng th·∫ø gi·ªõi.</p>
        </section>

        <section id="todo" class="tool-card active">
            <div style="display: flex; justify-content: space-between;">
                <h3>Danh s√°ch c√¥ng vi·ªác</h3>
                <button onclick="exportToExcel()" style="background:var(--success)">Xu·∫•t Excel</button>
            </div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="todoInput" placeholder="Th√™m vi·ªác m·ªõi...">
                <button onclick="addTodo()">Th√™m</button>
            </div>
            <div id="todoList" style="margin-top:15px;"></div>
        </section>

        <section id="pomodoro" class="tool-card">
            <h3>Pomodoro - L√†m vi·ªác t·∫≠p trung</h3>
            <div class="timer-display" id="timerDisplay">25:00</div>
            <div style="display: flex; justify-content: center; gap: 10px;">
                <button onclick="startPomo()">B·∫Øt ƒë·∫ßu</button>
                <button onclick="pausePomo()" style="background:#94a3b8">T·∫°m d·ª´ng</button>
                <button onclick="resetPomo()" style="background:var(--danger)">Reset</button>
            </div>
        </section>

        <section id="numToWord" class="tool-card">
            <h3>Chuy·ªÉn s·ªë th√†nh ch·ªØ (VND)</h3>
            <input type="number" id="numInput" placeholder="V√≠ d·ª•: 5000000" oninput="convertNumToWord()">
            <div class="result-box" id="wordResult">...</div>
        </section>

        <section id="flashcards" class="tool-card">
            <h3>Ghi nh·ªõ th√¥ng minh</h3>
            <div class="flashcard-inner" onclick="flipCard()">
                <div class="card-body" id="cardInner">
                    <div class="card-front" id="cardFront">B·∫•m ƒë·ªÉ l·∫≠t th·∫ª</div>
                    <div class="card-back" id="cardBack">M·∫∑t sau ƒë√°p √°n</div>
                </div>
            </div>
            <div style="text-align: center; margin-bottom: 20px;">
                <button onclick="prevCard()">‚Üê</button>
                <span id="cardIdx">0 / 0</span>
                <button onclick="nextCard()">‚Üí</button>
            </div>
            <input id="fFront" placeholder="C√¢u h·ªèi">
            <input id="fBack" placeholder="C√¢u tr·∫£ l·ªùi">
            <button onclick="addFlashcard()">Th√™m th·∫ª m·ªõi</button>
        </section>

        <section id="notes" class="tool-card">
            <h3>Ghi ch√∫ nhanh</h3>
            <textarea id="noteArea" style="height:300px" oninput="saveNotes()" placeholder="Ghi ch√∫ s·∫Ω t·ª± ƒë·ªông l∆∞u l·∫°i..."></textarea>
        </section>

        <section id="calc" class="tool-card">
            <h3>M√°y t√≠nh %</h3>
            <input id="calcExp" placeholder="V√≠ d·ª•: 1500000 * 10% + 20000">
            <button onclick="calc()" style="width:100%">T√≠nh ngay</button>
            <div class="result-box" id="calcRes">0</div>
        </section>

        <section id="age" class="tool-card">
            <h3>T√≠nh tu·ªïi & Ng√†y s·ªëng</h3>
            <input type="date" id="birthDate" onchange="calcAge()">
            <div class="result-box" id="ageRes">...</div>
        </section>

        <section id="link" class="tool-card">
            <h3>R√∫t g·ªçn link nhanh</h3>
            <input id="longLink" placeholder="D√°n link d√†i t·∫°i ƒë√¢y...">
            <button onclick="shorten()">R√∫t g·ªçn</button>
            <div class="result-box" id="shortRes"></div>
        </section>
    </div>

    <script>
        // ƒêi·ªÅu h∆∞·ªõng
        function showTool(id, btn) {
            document.querySelectorAll('.tool-card').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }

        // --- ƒê·ªîI NGO·∫†I T·ªÜ (API Th·ª±c t·∫ø) ---
        async function convertCurrency() {
            const amount = document.getElementById('currAmount').value;
            const from = document.getElementById('currFrom').value;
            const resBox = document.getElementById('currResult');
            if (!amount) { resBox.innerText = "K·∫øt qu·∫£: 0 VND"; return; }
            resBox.innerText = "ƒêang c·∫≠p nh·∫≠t t·ª∑ gi√°...";
            try {
                const response = await fetch(`https://api.exchangerate-api.com/v4/latest/${from}`);
                const data = await response.json();
                const rate = data.rates.VND;
                const result = amount * rate;
                resBox.innerHTML = `K·∫øt qu·∫£: <b>${result.toLocaleString()} VND</b><br><small>T·ª∑ gi√°: 1 ${from} ‚âà ${rate.toLocaleString()} VND</small>`;
            } catch {
                resBox.innerText = "L·ªói k·∫øt n·ªëi t·ª∑ gi√°! H√£y th·ª≠ l·∫°i sau.";
            }
        }

        // --- TO-DO LIST & EXCEL ---
        let todos = JSON.parse(localStorage.getItem('off_todo')) || [];
        function renderTodo() {
            const list = document.getElementById('todoList');
            list.innerHTML = todos.map((t, i) => `
                <div class="todo-item">
                    <input type="checkbox" ${t.done?'checked':''} onclick="toggleTodo(${i})">
                    <span style="flex:1; margin-left:10px; ${t.done?'text-decoration:line-through;color:grey':''}"> ${t.text}</span>
                    <button onclick="delTodo(${i})" style="background:none;color:red">‚úï</button>
                </div>
            `).join('');
            localStorage.setItem('off_todo', JSON.stringify(todos));
        }
        function addTodo() {
            const val = document.getElementById('todoInput').value;
            if(val) { todos.push({text: val, done: false}); document.getElementById('todoInput').value=''; renderTodo(); }
        }
        function toggleTodo(i) { todos[i].done = !todos[i].done; renderTodo(); }
        function delTodo(i) { todos.splice(i, 1); renderTodo(); }
        function exportToExcel() {
            const ws = XLSX.utils.json_to_sheet(todos);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Tasks");
            XLSX.writeFile(wb, "Office_Tasks.xlsx");
        }
        renderTodo();

        // --- POMODORO ---
        let pTimer, pLeft = 1500;
        function updateP() {
            let m = Math.floor(pLeft/60).toString().padStart(2,'0'), s = (pLeft%60).toString().padStart(2,'0');
            document.getElementById('timerDisplay').innerText = `${m}:${s}`;
        }
        function startPomo() { clearInterval(pTimer); pTimer = setInterval(() => { pLeft--; updateP(); if(pLeft<=0) { clearInterval(pTimer); alert("H·∫øt gi·ªù l√†m vi·ªác!"); } }, 1000); }
        function pausePomo() { clearInterval(pTimer); }
        function resetPomo() { clearInterval(pTimer); pLeft = 1500; updateP(); }

        // --- S·ªê TH√ÄNH CH·ªÆ ---
        function convertNumToWord() {
            const n = document.getElementById('numInput').value;
            if(!n) return;
            document.getElementById('wordResult').innerText = to_vn(n) + " ƒë·ªìng.";
        }
        function to_vn(n) {
            const s = ["kh√¥ng","m·ªôt","hai","ba","b·ªën","nƒÉm","s√°u","b·∫£y","t√°m","ch√≠n"];
            function g(gr) {
                let r="", [c,h,d] = gr.padStart(3,'0').split('').map(Number);
                if(c==0&&h==0&&d==0) return "";
                if(c!=0) { r+=s[c]+" trƒÉm "; if(h==0&&d!=0) r+="l·∫ª "; }
                if(h!=0&&h!=1) { r+=s[h]+" m∆∞∆°i "; if(d==1) r+="m·ªët "; }
                if(h==1) r+="m∆∞·ªùi ";
                if(d!=0 && !(h>1&&d==1)) r+=(d==5&&h!=0?"lƒÉm ":s[d]+" ");
                return r;
            }
            let res="", i=0, u=["","ngh√¨n","tri·ªáu","t·ª∑"], ns=n.toString();
            while(ns.length>0) {
                let chunk = ns.slice(-3), rChunk = g(chunk);
                if(rChunk) res = rChunk + u[i] + " " + res;
                ns = ns.slice(0,-3); i++;
            }
            return res.trim().charAt(0).toUpperCase() + res.trim().slice(1);
        }

        // --- FLASHCARDS ---
        let cards = JSON.parse(localStorage.getItem('off_cards')) || [], cIdx = 0;
        function flipCard() { document.getElementById('cardInner').classList.toggle('flipped'); }
        function renderCard() {
            if(!cards.length) { document.getElementById('cardFront').innerText="Tr·ªëng"; document.getElementById('cardBack').innerText="Tr·ªëng"; return; }
            document.getElementById('cardFront').innerText = cards[cIdx].f;
            document.getElementById('cardBack').innerText = cards[cIdx].b;
            document.getElementById('cardIdx').innerText = `${cIdx+1} / ${cards.length}`;
        }
        function addFlashcard() {
            const f = document.getElementById('fFront').value, b = document.getElementById('fBack').value;
            if(f&&b) { cards.push({f,b}); localStorage.setItem('off_cards', JSON.stringify(cards)); renderCard(); }
        }
        function nextCard() { cIdx = (cIdx+1)%cards.length; renderCard(); }
        function prevCard() { cIdx = (cIdx-1+cards.length)%cards.length; renderCard(); }
        renderCard();

        // --- TI·ªÜN √çCH KH√ÅC ---
        function saveNotes() { localStorage.setItem('off_notes', document.getElementById('noteArea').value); }
        document.getElementById('noteArea').value = localStorage.getItem('off_notes') || '';
        function calc() { try { document.getElementById('calcRes').innerText = eval(document.getElementById('calcExp').value.replace(/%/g,'/100')).toLocaleString(); } catch { alert("L·ªói!"); } }
        function calcAge() {
            const b = new Date(document.getElementById('birthDate').value), n = new Date();
            let y = n.getFullYear()-b.getFullYear();
            document.getElementById('ageRes').innerText = `${y} tu·ªïi. (ƒê√£ s·ªëng kho·∫£ng ${Math.floor((n-b)/(1000*60*60*24))} ng√†y)`;
        }
        async function shorten() {
            const l = document.getElementById('longLink').value;
            const res = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(l)}`);
            document.getElementById('shortRes').innerText = await res.text();
        }
    </script>
</body>
</html>
