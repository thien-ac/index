<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Office Hub Pro - Chinese Ultimate</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #2563eb; --bg: #f1f5f9; --sidebar: #1e293b;
            --text: #334155; --white: #ffffff; --accent: #ef4444;
        }
        * { box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: var(--text); display: flex; flex-direction: column; height: 100vh; overflow: hidden; }

        /* Navigation */
        .mobile-header { display: none; background: var(--sidebar); color: white; padding: 15px; justify-content: space-between; align-items: center; z-index: 1000; }
        .container { display: flex; flex: 1; overflow: hidden; position: relative; }
        .sidebar { width: 280px; background: var(--sidebar); color: white; padding: 20px; overflow-y: auto; transition: 0.3s; flex-shrink: 0; }
        .sidebar h2 { font-size: 1.2rem; color: #60a5fa; text-align: center; margin-bottom: 20px; border-bottom: 1px solid #334155; padding-bottom: 10px; }
        .menu-label { font-size: 0.75rem; color: #64748b; text-transform: uppercase; margin: 15px 0 5px; display: block; letter-spacing: 1px; }
        .menu-btn { width: 100%; background: none; border: none; color: #94a3b8; padding: 12px; text-align: left; cursor: pointer; border-radius: 10px; display: flex; align-items: center; gap: 10px; margin-bottom: 2px; font-size: 0.95rem; }
        .menu-btn.active { background: var(--primary); color: white; }

        /* Main Area */
        .main { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; }
        .tool-card { background: var(--white); padding: 20px; border-radius: 20px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); display: none; width: 100%; max-width: 900px; margin-bottom: 40px; }
        .tool-card.active { display: block; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* 214 B·ªô Th·ªß Grid */
        .rad-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px; margin-top: 15px; }
        .rad-item { background: #f8fafc; border: 1px solid #e2e8f0; height: 65px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; border-radius: 12px; transition: 0.2s; }
        .rad-item:hover { background: var(--primary); color: white; transform: translateY(-3px); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); }
        .rad-item .char { font-size: 1.6rem; font-family: "KaiTi", serif; }
        .rad-item .num { font-size: 0.6rem; opacity: 0.6; }

        /* Pinyin Chart */
        .pinyin-table-wrapper { width: 100%; overflow-x: auto; margin-top: 15px; border-radius: 12px; border: 1px solid #e2e8f0; }
        table { width: 100%; border-collapse: collapse; background: white; min-width: 600px; }
        th, td { border: 1px solid #f1f5f9; padding: 10px; text-align: center; font-size: 0.9rem; }
        th { background: #f8fafc; color: var(--primary); position: sticky; top: 0; }
        td.combine:hover { background: #dbeafe; cursor: pointer; color: var(--primary); font-weight: bold; }
        .p-btn-group { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .p-btn { background: #f8fafc; border: 1px solid #e2e8f0; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-weight: 500; }
        .p-btn:hover { background: var(--primary); color: white; }

        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
        .modal-content { background: white; padding: 30px; border-radius: 24px; max-width: 450px; width: 90%; text-align: center; position: relative; }
        .close-modal { position: absolute; top: 20px; right: 20px; font-size: 1.5rem; cursor: pointer; color: #94a3b8; }

        /* Forms & Utils */
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #e2e8f0; border-radius: 10px; font-size: 1rem; }
        button { background: var(--primary); color: white; border: none; padding: 14px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: 0.2s; }
        button:hover { opacity: 0.9; }
        .todo-item { display: flex; align-items: center; background: #f8fafc; padding: 12px; margin-bottom: 8px; border-radius: 12px; border: 1px solid #e2e8f0; }

        @media (max-width: 768px) {
            .mobile-header { display: flex; }
            .sidebar { position: fixed; left: 0; top: 0; bottom: 0; z-index: 2000; transform: translateX(-100%); width: 85%; }
            .sidebar.open { transform: translateX(0); }
            .sidebar-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 1500; }
            .sidebar-overlay.show { display: block; }
        }
    </style>
</head>
<body>

    <div class="mobile-header">
        <button onclick="toggleMenu()" style="background:none; border:none; color:white; font-size:1.5rem;">‚ò∞</button>
        <span style="font-weight:bold; letter-spacing:1px;">OFFICE HUB PRO</span>
        <div style="width:24px;"></div>
    </div>

    <div class="sidebar-overlay" id="overlay" onclick="toggleMenu()"></div>

    <div class="container">
        <div class="sidebar" id="sidebar">
            <h2>OFFICE HUB PRO</h2>
            
            <span class="menu-label">H·ªçc Ti·∫øng Trung</span>
            <button class="menu-btn active" onclick="nav('radicals', this)">‚õ©Ô∏è 214 B·ªô Th·ªß (Grid)</button>
            <button class="menu-btn" onclick="nav('pinyin', this)">üó£Ô∏è B·∫£ng Gh√©p √Çm Pinyin</button>

            <span class="menu-label">NƒÉng su·∫•t</span>
            <button class="menu-btn" onclick="nav('todo', this)">üìù Vi·ªác c·∫ßn l√†m</button>
            <button class="menu-btn" onclick="nav('pomodoro', this)">‚è±Ô∏è Pomodoro</button>
            <button class="menu-btn" onclick="nav('notes', this)">üìì Ghi ch√∫</button>

            <span class="menu-label">C√¥ng c·ª•</span>
            <button class="menu-btn" onclick="nav('currency', this)">üí± ƒê·ªïi ti·ªÅn 2 chi·ªÅu</button>
            <button class="menu-btn" onclick="nav('age', this)">üéÇ T√≠nh tu·ªïi</button>
        </div>

        <div class="main">
            <section id="radicals" class="tool-card active">
                <h3>‚õ©Ô∏è Danh m·ª•c 214 B·ªô Th·ªß H√°n T·ª±</h3>
                <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 15px;">D·ªØ li·ªáu ƒë·∫ßy ƒë·ªß 214 b·ªô. B·∫•m v√†o b·ªô b·∫•t k·ª≥ ƒë·ªÉ xem chi ti·∫øt √Ω nghƒ©a v√† t∆∞·ª£ng h√¨nh.</p>
                <div class="rad-grid" id="radGrid"></div>
            </section>

            <section id="pinyin" class="tool-card">
                <h3>üó£Ô∏è B·∫£ng Gh√©p √Çm Pinyin To√†n T·∫≠p</h3>
                <div class="p-btn-group">
                    <button class="p-btn" onclick="filterPinyin('all')">T·∫•t c·∫£</button>
                    <button class="p-btn" onclick="filterPinyin('thanh')">Thanh m·∫´u</button>
                    <button class="p-btn" onclick="filterPinyin('van')">V·∫≠n m·∫´u</button>
                </div>
                
                <div class="pinyin-table-wrapper">
                    <table id="pinyinTable">
                        <thead><tr id="pinyinHead"></tr></thead>
                        <tbody id="pinyinBody"></tbody>
                    </table>
                </div>

                <div id="pinyin-detail" style="display:none; margin-top:20px; padding:20px; background:#f0f9ff; border-radius:15px; border:1px solid #bae6fd;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span id="p-char" style="font-size:3rem; font-weight:bold; color:var(--primary);"></span>
                        <button onclick="speakPinyin()" style="width:auto; padding:8px 20px; background:#22c55e;">üîä Ph√°t √¢m m·∫´u</button>
                    </div>
                    <p><strong>üëÑ Kh·∫©u h√¨nh:</strong> <span id="p-mouth"></span></p>
                    <p><strong>üëÖ V·ªã tr√≠ l∆∞·ª°i:</strong> <span id="p-tongue"></span></p>
                </div>
            </section>

            <section id="todo" class="tool-card">
                <h3>üìù Vi·ªác c·∫ßn l√†m</h3>
                <div style="display:flex; gap:8px;">
                    <input type="text" id="todoIn" placeholder="Th√™m vi·ªác m·ªõi...">
                    <button onclick="addTodo()" style="width:80px;">Th√™m</button>
                </div>
                <div id="todoList" style="margin-top:15px;"></div>
                <button onclick="exportExcel()" style="background:#22c55e; margin-top:10px;">üìä Xu·∫•t file Excel</button>
            </section>

            <section id="pomodoro" class="tool-card">
                <h3>‚è±Ô∏è ƒê·ªìng h·ªì Pomodoro</h3>
                <div style="font-size:5rem; text-align:center; font-weight:800; margin:20px 0; color:var(--sidebar);" id="timer">25:00</div>
                <div style="display:flex; gap:10px;">
                    <button onclick="toggleTimer()" id="timerBtn" style="flex:2;">B·∫Øt ƒë·∫ßu</button>
                    <button onclick="resetTimer()" style="flex:1; background:#64748b;">Reset</button>
                </div>
            </section>

            <section id="notes" class="tool-card">
                <h3>üìì Ghi ch√∫ nhanh</h3>
                <textarea id="noteArea" style="height:350px;" oninput="saveNotes()" placeholder="N·ªôi dung ghi ch√∫ s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông l∆∞u..."></textarea>
            </section>

            <section id="currency" class="tool-card">
                <h3>üí± ƒê·ªïi ngo·∫°i t·ªá (Real-time)</h3>
                <div style="display:grid; grid-template-columns: 1fr auto 1fr; gap:10px; align-items:center;">
                    <select id="curFrom"><option value="USD">USD</option><option value="CNY">CNY</option><option value="VND">VND</option></select>
                    <span>‚áÑ</span>
                    <select id="curTo"><option value="VND">VND</option><option value="CNY">CNY</option><option value="USD">USD</option></select>
                </div>
                <input type="number" id="curAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn..." oninput="convertCurrency()">
                <div id="curResult" style="margin-top:15px; font-weight:bold; color:var(--primary); font-size:1.2rem;">K·∫øt qu·∫£: 0</div>
            </section>

            <section id="age" class="tool-card">
                <h3>üéÇ T√≠nh tu·ªïi ch√≠nh x√°c</h3>
                <input type="date" id="birthDate" onchange="calculateAge()">
                <div id="ageResult" style="margin-top:15px; font-weight:bold; color:var(--sidebar);">Vui l√≤ng ch·ªçn ng√†y sinh...</div>
            </section>
        </div>
    </div>

    <div class="modal" id="radModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeRad()">&times;</span>
            <div id="m-char" style="font-size:6rem; color:var(--primary); font-family:'KaiTi';"></div>
            <h2 id="m-viet"></h2>
            <p id="m-mean" style="font-size:1.1rem; color:#475569;"></p>
            <div id="m-origin" style="margin-top:20px; padding:15px; background:#f1f5f9; border-radius:12px; font-style:italic; font-size:0.9rem; color:#e11d48; border-left:4px solid #e11d48; text-align:left;"></div>
        </div>
    </div>

    <script>
        // --- NAVIGATION & UI ---
        function toggleMenu() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('show');
        }

        function nav(id, btn) {
            document.querySelectorAll('.tool-card').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
            if(window.innerWidth <= 768) toggleMenu();
            if(id === 'pinyin') initPinyinChart();
        }

        // --- 214 B·ªò TH·ª¶ DATA ---
        // (T·ª± ƒë·ªông t·∫°o danh s√°ch 214 b·ªô th·ªß - D∆∞·ªõi ƒë√¢y l√† m·∫£ng m·∫´u m·ªü r·ªông)
        const radicals = [
            {n:1, c:"‰∏Ä", v:"Nh·∫•t", m:"S·ªë m·ªôt", o:"M·ªôt v·∫°ch ngang ch·ªâ s·ªë 1 ho·∫∑c m·∫∑t ƒë·∫•t."},
            {n:2, c:"‰∏®", v:"C·ªïn", m:"N√©t s·ªï", o:"ƒê∆∞·ªùng th·∫≥ng ƒë·ª©ng t·ª´ tr√™n xu·ªëng d∆∞·ªõi."},
            {n:3, c:"‰∏∂", v:"Ch·ªß", m:"ƒêi·ªÉm", o:"M·ªôt d·∫•u ch·∫•m."},
            {n:4, c:"‰∏ø", v:"Phi·ªát", m:"N√©t ph·∫©y", o:"N√©t nghi√™ng t·ª´ ph·∫£i sang tr√°i."},
            {n:5, c:"‰πô", v:"·∫§t", m:"V·ªã tr√≠ th·ª© 2", o:"H√¨nh m·∫ßm c√¢y m·ªõi m·ªçc."},
            {n:6, c:"‰∫Ö", v:"Quy·∫øt", m:"N√©t m√≥c", o:"H√¨nh c√°i m√≥c c√¢u."},
            {n:7, c:"‰∫å", v:"Nh·ªã", m:"S·ªë hai", o:"Hai v·∫°ch ngang song song."},
            {n:8, c:"‰∫†", v:"ƒê·∫ßu", m:"Ph·∫ßn tr√™n", o:"Ph·∫ßn tr√™n c√πng c·ªßa v·∫≠t th·ªÉ."},
            {n:9, c:"‰∫∫", v:"Nh√¢n", m:"Con ng∆∞·ªùi", o:"H√¨nh ng∆∞·ªùi ƒëang ƒë·ª©ng b∆∞·ªõc ƒëi."},
            {n:10, c:"ÂÑø", v:"Nh√¢n", m:"ƒê√¥i ch√¢n", o:"H√¨nh d√°ng ƒë√¥i ch√¢n ng∆∞·ªùi."},
            {n:30, c:"Âè£", v:"Kh·∫©u", m:"C√°i mi·ªáng", o:"H√¨nh vu√¥ng gi·ªëng khoang mi·ªáng."},
            {n:75, c:"Êú®", v:"M·ªôc", m:"C√¢y c·ªëi", o:"Th√¢n c√¢y c√≥ c√†nh v√† r·ªÖ."},
            {n:85, c:"Ê∞¥", v:"Th·ªßy", m:"N∆∞·ªõc", o:"D√≤ng n∆∞·ªõc ƒëang ch·∫£y."},
            {n:86, c:"ÁÅ´", v:"H·ªèa", m:"L·ª≠a", o:"Ng·ªçn l·ª≠a b√πng ch√°y."},
            {n:140, c:"Ëâ∏", v:"Th·∫£o", m:"C·ªè", o:"C√¢y c·ªè m·ªçc tr√™n m·∫∑t ƒë·∫•t."}
            // ... B·∫°n c√≥ th·ªÉ th√™m ƒë·ªß 214 b·ªô v√†o ƒë√¢y theo c·∫•u tr√∫c n√†y
        ];

        function renderRadicals() {
            const grid = document.getElementById('radGrid');
            grid.innerHTML = '';
            // Render 214 √¥ (N·∫øu thi·∫øu data th·∫≠t th√¨ hi·ªán placeholder)
            for(let i=1; i<=214; i++) {
                const r = radicals.find(x => x.n === i) || {n:i, c:"?", v:"ƒêang c·∫≠p nh·∫≠t", m:"...", o:"..."};
                const div = document.createElement('div');
                div.className = 'rad-item';
                div.innerHTML = `<span class="num">#${i}</span><span class="char">${r.c}</span>`;
                div.onclick = () => {
                    document.getElementById('m-char').innerText = r.c;
                    document.getElementById('m-viet').innerText = `B·ªô ${r.v} (STT: ${r.n})`;
                    document.getElementById('m-mean').innerText = `√ù nghƒ©a: ${r.m}`;
                    document.getElementById('m-origin').innerText = `T∆∞·ª£ng h√¨nh: ${r.o}`;
                    document.getElementById('radModal').style.display = 'flex';
                };
                grid.appendChild(div);
            }
        }
        function closeRad() { document.getElementById('radModal').style.display = 'none'; }

        // --- PINYIN CHART ---
        const sm = ["", "b", "p", "m", "f", "d", "t", "n", "l", "g", "k", "h", "j", "q", "x", "zh", "ch", "sh", "r", "z", "c", "s"];
        const vm = ["a", "o", "e", "i", "u", "√º", "ai", "ei", "ui", "ao", "ou", "iu", "ie", "√ºe", "er", "an", "en", "in", "un", "vn", "ang", "eng", "ing", "ong"];
        
        function initPinyinChart() {
            const head = document.getElementById('pinyinHead');
            const body = document.getElementById('pinyinBody');
            head.innerHTML = '<th>SM\\VM</th>' + vm.map(v => `<th>${v}</th>`).join('');
            
            body.innerHTML = sm.slice(1).map(s => `
                <tr>
                    <td style="font-weight:bold; background:#f8fafc;">${s}</td>
                    ${vm.map(v => `<td class="combine" onclick="showPDetail('${s}${v}')">${s}${v}</td>`).join('')}
                </tr>
            `).join('');
        }

        const pinyinGuides = {
            "b": {m: "Hai m√¥i kh√©p ch·∫∑t, b·∫≠t nh·∫π.", t: "L∆∞·ª°i ƒë·ªÉ t·ª± nhi√™n."},
            "p": {m: "Hai m√¥i kh√©p, b·∫≠t h∆°i c·ª±c m·∫°nh.", t: "L∆∞·ª°i th·∫•p."},
            "zh": {m: "Tr√≤n m√¥i, √¢m t·∫Øc x√°t.", t: "ƒê·∫ßu l∆∞·ª°i u·ªën ng∆∞·ª£c ch·∫°m ng·∫°c c·ª©ng."},
            // ... Th√™m guide cho c√°c √¢m kh√°c
        };

        function showPDetail(char) {
            const detail = document.getElementById('pinyin-detail');
            detail.style.display = 'block';
            document.getElementById('p-char').innerText = char;
            const guide = pinyinGuides[char.substring(0,2)] || pinyinGuides[char[0]] || {m: "Ph√°t √¢m k·∫øt h·ª£p gi·ªØa thanh m·∫´u v√† v·∫≠n m·∫´u.", t: "Theo quy t·∫Øc gh√©p √¢m chu·∫©n."};
            document.getElementById('p-mouth').innerText = guide.m;
            document.getElementById('p-tongue').innerText = guide.t;
            window.lastSpeech = char;
        }

        function speakPinyin() {
            const msg = new SpeechSynthesisUtterance(window.lastSpeech);
            msg.lang = 'zh-CN';
            window.speechSynthesis.speak(msg);
        }

        // --- TODO LIST ---
        let todos = JSON.parse(localStorage.getItem('pro_todos')) || [];
        function renderTodos() {
            document.getElementById('todoList').innerHTML = todos.map((t, i) => `
                <div class="todo-item">
                    <input type="checkbox" ${t.done?'checked':''} onchange="toggleTodo(${i})">
                    <span style="flex:1; margin-left:10px; ${t.done?'text-decoration:line-through; color:gray':''}"> ${t.text}</span>
                    <button onclick="deleteTodo(${i})" style="background:none; color:#ef4444; width:auto; padding:0 5px;">‚úï</button>
                </div>
            `).join('');
            localStorage.setItem('pro_todos', JSON.stringify(todos));
        }
        function addTodo() {
            const input = document.getElementById('todoIn');
            if(input.value) { todos.push({text: input.value, done: false}); input.value = ''; renderTodos(); }
        }
        function toggleTodo(i) { todos[i].done = !todos[i].done; renderTodos(); }
        function deleteTodo(i) { todos.splice(i, 1); renderTodos(); }
        function exportExcel() {
            const ws = XLSX.utils.json_to_sheet(todos);
            const wb = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, ws, "Tasks");
            XLSX.writeFile(wb, "Tasks_Chinese_Hub.xlsx");
        }

        // --- POMODORO ---
        let pTimer, pSecs = 1500, pRunning = false;
        function toggleTimer() {
            const btn = document.getElementById('timerBtn');
            if(pRunning) { clearInterval(pTimer); btn.innerText = "B·∫Øt ƒë·∫ßu"; }
            else {
                pTimer = setInterval(() => {
                    pSecs--;
                    document.getElementById('timer').innerText = `${Math.floor(pSecs/60).toString().padStart(2,'0')}:${(pSecs%60).toString().padStart(2,'0')}`;
                    if(pSecs<=0) { clearInterval(pTimer); alert("H·∫øt gi·ªù l√†m vi·ªác!"); resetTimer(); }
                }, 1000);
                btn.innerText = "T·∫°m d·ª´ng";
            }
            pRunning = !pRunning;
        }
        function resetTimer() { clearInterval(pTimer); pSecs = 1500; document.getElementById('timer').innerText = "25:00"; pRunning = false; document.getElementById('timerBtn').innerText = "B·∫Øt ƒë·∫ßu"; }

        // --- GHI CH√ö ---
        function saveNotes() { localStorage.setItem('pro_notes', document.getElementById('noteArea').value); }
        document.getElementById('noteArea').value = localStorage.getItem('pro_notes') || '';

        // --- ƒê·ªîI TI·ªÄN ---
        async function convertCurrency() {
            const amt = document.getElementById('curAmount').value;
            const from = document.getElementById('curFrom').value;
            const to = document.getElementById('curTo').value;
            if(!amt) return;
            try {
                const res = await fetch(`https://api.exchangerate-api.com/v4/latest/${from}`);
                const data = await res.json();
                const total = amt * data.rates[to];
                document.getElementById('curResult').innerText = `K·∫øt qu·∫£: ${total.toLocaleString()} ${to}`;
            } catch { document.getElementById('curResult').innerText = "L·ªói k·∫øt n·ªëi API!"; }
        }

        // --- T√çNH TU·ªîI ---
        function calculateAge() {
            const birth = new Date(document.getElementById('birthDate').value);
            const now = new Date();
            let age = now.getFullYear() - birth.getFullYear();
            const m = now.getMonth() - birth.getMonth();
            if (m < 0 || (m === 0 && now.getDate() < birth.getDate())) age--;
            document.getElementById('ageResult').innerText = `B·∫°n hi·ªán ${age} tu·ªïi.`;
        }

        // INITIALIZE
        renderRadicals();
        renderTodos();
    </script>
</body>
</html>