<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Office Hub Pro - Chinese Ultimate v2</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #2563eb; --bg: #f8fafc; --sidebar: #0f172a;
            --text: #1e293b; --white: #ffffff; --accent: #e11d48;
        }
        * { box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { margin: 0; background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; }

        /* Sidebar */
        .sidebar { width: 280px; background: var(--sidebar); color: white; padding: 20px; overflow-y: auto; flex-shrink: 0; transition: 0.3s; }
        .sidebar h2 { font-size: 1.2rem; color: #38bdf8; text-align: center; margin-bottom: 25px; border-bottom: 1px solid #334155; padding-bottom: 10px; }
        .menu-label { font-size: 0.7rem; color: #64748b; text-transform: uppercase; margin: 15px 0 5px; display: block; }
        .menu-btn { width: 100%; background: none; border: none; color: #94a3b8; padding: 12px; text-align: left; cursor: pointer; border-radius: 10px; display: flex; align-items: center; gap: 10px; margin-bottom: 3px; transition: 0.2s; }
        .menu-btn:hover { background: #1e293b; color: white; }
        .menu-btn.active { background: var(--primary); color: white; }

        /* Main Content */
        .main { flex: 1; padding: 25px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; }
        .tool-card { background: var(--white); padding: 25px; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); display: none; width: 100%; max-width: 1000px; }
        .tool-card.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* 214 Radicals Grid */
        .rad-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); gap: 12px; margin-top: 15px; }
        .rad-item { background: #fff; border: 1px solid #e2e8f0; height: 80px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; border-radius: 15px; transition: 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .rad-item:hover { border-color: var(--primary); transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.2); }
        .rad-item .char { font-size: 1.8rem; font-family: "KaiTi", "BiauKai", serif; color: var(--primary); }
        .rad-item .pinyin { font-size: 0.7rem; font-weight: bold; color: #64748b; }

        /* Pinyin Chart */
        .pinyin-scroll { width: 100%; overflow-x: auto; border-radius: 15px; border: 1px solid #e2e8f0; margin-top: 15px; }
        table { width: 100%; border-collapse: collapse; background: white; white-space: nowrap; }
        th, td { border: 1px solid #f1f5f9; padding: 12px 15px; text-align: center; }
        th { background: #f8fafc; color: var(--primary); font-size: 0.8rem; }
        td.cell:hover { background: #dbeafe; cursor: pointer; font-weight: bold; color: var(--primary); }

        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(15, 23, 42, 0.8); z-index: 9999; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
        .modal-content { background: white; padding: 40px; border-radius: 30px; max-width: 500px; width: 90%; text-align: center; position: relative; }
        .close-btn { position: absolute; top: 20px; right: 20px; font-size: 1.5rem; cursor: pointer; color: #94a3b8; }

        /* Utilities */
        .btn-green { background: #10b981; }
        input, textarea, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #e2e8f0; border-radius: 12px; outline: none; }
        button { border: none; padding: 12px 20px; border-radius: 12px; cursor: pointer; font-weight: 600; color: white; background: var(--primary); transition: 0.2s; }
        button:hover { opacity: 0.9; }

        @media (max-width: 768px) {
            .sidebar { position: fixed; left: -280px; top: 0; bottom: 0; z-index: 10000; }
            .sidebar.open { left: 0; }
            .main { padding: 15px; }
        }
    </style>
</head>
<body>

    <div class="sidebar" id="sidebar">
        <h2>OFFICE HUB PRO</h2>
        <span class="menu-label">H·ªçc t·∫≠p</span>
        <button class="menu-btn active" onclick="nav('radicals', this)">‚õ©Ô∏è 214 B·ªô Th·ªß</button>
        <button class="menu-btn" onclick="nav('pinyin', this)">üó£Ô∏è B·∫£ng Gh√©p Pinyin</button>
        
        <span class="menu-label">C√° nh√¢n</span>
        <button class="menu-btn" onclick="nav('todo', this)">üìù Vi·ªác c·∫ßn l√†m</button>
        <button class="menu-btn" onclick="nav('pomodoro', this)">‚è±Ô∏è Pomodoro</button>
        <button class="menu-btn" onclick="nav('notes', this)">üìì Ghi ch√∫</button>
        
        <span class="menu-label">Ti·ªán √≠ch</span>
        <button class="menu-btn" onclick="nav('currency', this)">üí± ƒê·ªïi ngo·∫°i t·ªá</button>
    </div>

    <div class="main">
        <section id="radicals" class="tool-card active">
            <h3>‚õ©Ô∏è Tr·ªçn b·ªô 214 B·ªô Th·ªß Ti·∫øng Trung</h3>
            <p style="color: #64748b; font-size: 0.9rem;">B·∫•m v√†o t·ª´ng b·ªô ƒë·ªÉ xem chi ti·∫øt Pinyin, H√°n Vi·ªát v√† √Ω nghƒ©a.</p>
            <div class="rad-grid" id="radGrid"></div>
        </section>

        <section id="pinyin" class="tool-card">
            <h3>üó£Ô∏è B·∫£ng Gh√©p √Çm Pinyin To√†n T·∫≠p</h3>
            <div class="pinyin-scroll">
                <table id="pTable">
                    <thead><tr id="pHead"></tr></thead>
                    <tbody id="pBody"></tbody>
                </table>
            </div>
            <div id="pDetail" style="display:none; margin-top:20px; background:#eff6ff; padding:20px; border-radius:20px;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span id="pChar" style="font-size:3.5rem; font-weight:bold; color:var(--primary);"></span>
                    <button onclick="speakPinyin()">üîä Nghe Ph√°t √Çm</button>
                </div>
                <p><strong>Kh·∫©u h√¨nh:</strong> <span id="pMouth"></span></p>
                <p><strong>V·ªã tr√≠ l∆∞·ª°i:</strong> <span id="pTongue"></span></p>
            </div>
        </section>

        <section id="todo" class="tool-card">
            <h3>üìù Danh s√°ch vi·ªác c·∫ßn l√†m</h3>
            <div style="display:flex; gap:10px;">
                <input type="text" id="todoIn" placeholder="H√¥m nay b·∫°n c·∫ßn l√†m g√¨?">
                <button onclick="addTodo()" style="width:100px;">Th√™m</button>
            </div>
            <div id="todoList" style="margin-top:20px;"></div>
            <button onclick="exportExcel()" class="btn-green" style="margin-top:20px;">üì• Xu·∫•t Excel</button>
        </section>

        <section id="pomodoro" class="tool-card">
            <h3>‚è±Ô∏è ƒê·ªìng h·ªì Pomodoro</h3>
            <div style="font-size:6rem; text-align:center; font-weight:800; color:var(--sidebar);" id="timer">25:00</div>
            <div style="display:flex; gap:15px; justify-content:center;">
                <button onclick="toggleTimer()" id="tBtn" style="padding:15px 40px; font-size:1.2rem;">B·∫Øt ƒë·∫ßu</button>
                <button onclick="resetTimer()" style="background:#64748b;">Reset</button>
            </div>
        </section>

        <section id="notes" class="tool-card">
            <h3>üìì Ghi ch√∫ c√° nh√¢n</h3>
            <textarea id="noteArea" style="height:400px;" oninput="saveNotes()" placeholder="Ghi ch√∫ c·ªßa b·∫°n s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông l∆∞u l·∫°i..."></textarea>
        </section>

        <section id="currency" class="tool-card">
            <h3>üí± Chuy·ªÉn ƒë·ªïi ngo·∫°i t·ªá</h3>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                <select id="curFrom"><option value="USD">USD - ƒê√¥ la M·ªπ</option><option value="CNY" selected>CNY - Nh√¢n d√¢n t·ªá</option><option value="VND">VND - Vi·ªát Nam ƒê·ªìng</option></select>
                <select id="curTo"><option value="VND" selected>VND - Vi·ªát Nam ƒê·ªìng</option><option value="CNY">CNY - Nh√¢n d√¢n t·ªá</option><option value="USD">USD - ƒê√¥ la M·ªπ</option></select>
            </div>
            <input type="number" id="curAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn..." oninput="convert()">
            <div id="curRes" style="margin-top:20px; font-size:1.5rem; font-weight:bold; color:var(--primary); text-align:center;">K·∫øt qu·∫£: 0</div>
        </section>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div id="mChar" style="font-size:7rem; color:var(--primary); font-family:'KaiTi';"></div>
            <h2 id="mViet"></h2>
            <p id="mPinyin" style="font-size:1.5rem; font-weight:bold; color:#64748b;"></p>
            <p id="mMean" style="font-size:1.2rem; margin-top:10px;"></p>
            <div id="mDesc" style="background:#f1f5f9; padding:15px; border-radius:15px; font-style:italic; margin-top:20px; color:var(--accent);"></div>
        </div>
    </div>

    <script>
        // --- DATA B·ªò TH·ª¶ --- (ƒê√£ n√©n, t·ª± ƒë·ªông gi·∫£i n√©n khi load)
        const radData = [
            ["‰∏Ä","yƒ´","Nh·∫•t","S·ªë m·ªôt","M·ªôt v·∫°ch ngang"], ["‰∏®","g«în","C·ªïn","N√©t s·ªï","ƒê∆∞·ªùng th·∫≥ng ƒë·ª©ng"],
            ["‰∏∂","zh«î","Ch·ªß","ƒêi·ªÉm","D·∫•u ch·∫•m"], ["‰∏ø","piƒõ","Phi·ªát","N√©t ph·∫©y","N√©t xi√™n"],
            ["‰πô","y«ê","·∫§t","V·ªã tr√≠ th·ª© 2","M·∫ßm c√¢y m·ªõi m·ªçc"], ["‰∫Ö","ju√©","Quy·∫øt","N√©t m√≥c","C√°i m√≥c c√¢u"],
            ["‰∫å","√®r","Nh·ªã","S·ªë hai","Hai v·∫°ch ngang"], ["‰∫†","t√≥u","ƒê·∫ßu","Ph·∫ßn tr√™n","Che ƒë·∫≠y ·ªü tr√™n"],
            ["‰∫∫","r√©n","Nh√¢n","Con ng∆∞·ªùi","H√¨nh ng∆∞·ªùi ƒëang ƒëi"], ["ÂÑø","√©r","Nh√¢n (ch√¢n)","ƒê√¥i ch√¢n","H√¨nh ƒë√¥i ch√¢n"],
            ["ÂÖ•","r√π","Nh·∫≠p","V√†o trong","H√¨nh v·∫≠t ƒëi v√†o"], ["ÂÖ´","bƒÅ","B√°t","S·ªë t√°m","Hai n√©t x√≤e ra"],
            ["ÂÜÇ","ji≈çng","Quynh","V√πng bi√™n","V√πng ƒë·∫•t tr·ªëng"], ["ÂÜñ","m√¨","M·ªãch","Tr√πm l√™n","Chi·∫øc khƒÉn che"],
            ["ÂÜ´","bƒ´ng","BƒÉng","N∆∞·ªõc ƒë√°","Hai gi·ªçt n∆∞·ªõc ƒë√¥ng"], ["Âá†","jƒ´","K·ª∑","C√°i gh·∫ø","C√°i b√†n nh·ªè"],
            ["Âáµ","k«ém","Kh·∫£m","H√° mi·ªáng","V·∫≠t ƒë·ª±ng r·ªóng"], ["ÂàÄ","dƒÅo","ƒêao","Con dao","Hung kh√≠ h√¨nh dao"],
            ["Âäõ","l√¨","L·ª±c","S·ª©c m·∫°nh","H√¨nh c√°i c√†y n√¥ng nghi·ªáp"], ["Âãπ","bƒÅo","Bao","Bao b·ªçc","Ng∆∞·ªùi khom bao b·ªçc"],
            ["Âåï","b«ê","Ch·ªßy","C√°i th√¨a","C√°i mu·ªóng"], ["Âåö","fƒÅng","Ph∆∞∆°ng","V·∫≠t ƒë·ª±ng","C√°i khay ch·ª©a"],
            ["Âå∏","x√¨","H·ªá","Che ƒë·∫≠y","V·∫≠t ƒë∆∞·ª£c gi·∫•u k√≠n"], ["ÂçÅ","sh√≠","Th·∫≠p","S·ªë m∆∞·ªùi","V·∫°ch ƒë·ª©ng v√† ngang"],
            ["Âçú","b«î","B·ªëc","Xem b√≥i","V·∫øt n·ª©t tr√™n mai r√πa"], ["Âç©","ji√©","Ti·∫øt","ƒê·ªët tre","ƒê·ªët tre ho·∫∑c con d·∫•u"],
            ["ÂéÇ","h«én","H√°n","S∆∞·ªùn n√∫i","V√°ch ƒë√°"], ["Âé∂","sƒ´","Kh∆∞","Ri√™ng t∆∞","C√°i k√©n t·∫±m"],
            ["Âèà","y√≤u","H·ª±u","L·∫°i l·∫ßn n·ªØa","B√†n tay l√†m vi·ªác"], ["Âè£","k«íu","Kh·∫©u","Mi·ªáng","H√¨nh khoang mi·ªáng"],
            ["Âúü","t«î","Th·ªï","ƒê·∫•t","C√¢y m·ªçc tr√™n ƒë·∫•t"], ["Â£´","sh√¨","Sƒ©","K·∫ª sƒ©","Ng∆∞·ªùi c√≥ h·ªçc th·ª©c"],
            ["Â§ä","suƒ´","Truy","ƒêi ch·∫≠m","D√°ng ƒëi ch·∫≠m r√£i"], ["Â§ï","xƒ´","T·ªãch","Bu·ªïi t·ªëi","TrƒÉng khuy·∫øt"],
            ["Â§ß","d√†","ƒê·∫°i","To l·ªõn","Ng∆∞·ªùi dang tay"], ["Â•≥","n«ö","N·ªØ","Ph·ª• n·ªØ","Ng∆∞·ªùi n·ªØ qu·ª≥ g·ªëi"],
            ["Â≠ê","z«ê","T·ª≠","Con c√°i","ƒê·ª©a tr·∫ª qu·∫•n t√£"], ["ÂÆÄ","mi√°n","Mi√™n","M√°i nh√†","M√°i che c√≥ ƒë·ªânh"],
            ["ÂØ∏","c√πn","Th·ªën","T·∫•c","Kho·∫£ng c√°ch b√†n tay"], ["Â∞è","xi«éo","Ti·ªÉu","Nh·ªè b√©","Ba n√©t v·ª•n"],
            ["Â∞¢","wƒÅng","U√¥ng","Y·∫øu ƒëu·ªëi","Ng∆∞·ªùi c√≥ ch√¢n qu√®"], ["Â∞∏","shƒ´","Thi","X√°c ch·∫øt","Ng∆∞·ªùi n·∫±m b·∫•t ƒë·ªông"],
            ["Â±Æ","ch√®","Tri·ªát","M·∫ßm non","C·ªè m·ªõi m·ªçc"], ["Â±±","shƒÅn","S∆°n","N√∫i","Ba ng·ªçn n√∫i"],
            ["Â∑ù","chuƒÅn","Xuy√™n","S√¥ng","D√≤ng n∆∞·ªõc ch·∫£y"], ["Â∑•","g≈çng","C√¥ng","C√¥ng vi·ªác","C√°i th∆∞·ªõc th·ª£"],
            ["Â∑±","j«ê","K·ª∑","C√°i m√¨nh","D√¢y u·ªën l∆∞·ª£n"], ["Â∑æ","jƒ´n","C√¢n","KhƒÉn","KhƒÉn treo"],
            ["Âπ≤","gƒÅn","Can","Can h·ªá","C√°i khi√™n"], ["Âπ∫","yƒÅo","Y√™u","Nh·ªè nh·∫Øn","S·ª£i ch·ªâ nh·ªè"],
            ["Âπø","gu«éng","Qu·∫£ng","R·ªông l·ªõn","Nh√† t·ª±a v√°ch ƒë√°"], ["Âª¥","y«ên","D·∫´n","ƒêi d√†i","B∆∞·ªõc ƒëi d√†i"],
            ["Âªæ","g«íng","C·ªßng","Ch·∫Øp tay","Hai tay d√¢ng l√™n"], ["Âºã","y√¨","D·∫∑c","B·∫Øn cung","C·ªçc g·ªó bu·ªôc d√¢y"],
            ["Âºì","g≈çng","Cung","C√¢y cung","H√¨nh c√°i cung"], ["ÂΩê","j√¨","K√Ω","M√µm l·ª£n","C√°i ƒë·∫ßu con v·∫≠t"],
            ["ÂΩ°","shƒÅn","Ë°´","L√¥ng t√≥c","V·ªát trang tr√≠"], ["ÂΩ≥","ch√¨","X√≠ch","B∆∞·ªõc ch√¢n","B∆∞·ªõc ch√¢n tr√°i"],
            ["ÂøÉ","xƒ´n","T√¢m","Tim","Qu·∫£ tim ng∆∞·ªùi"], ["Êàà","gƒì","Qua","C√°i m√°c","Binh kh√≠ d√†i"],
            ["Êà∂","h√π","H·ªô","C·ª≠a","C√°nh c·ª≠a m·ªôt c√°nh"], ["Êâã","sh«íu","Th·ªß","Tay","B√†n tay nƒÉm ng√≥n"],
            ["ÊîØ","zhƒ´","Chi","C√†nh c√¢y","Tay c·∫ßm c√†nh c√¢y"], ["Êî¥","p≈´","Ph·ªôc","ƒê√°nh nh·∫π","Tay c·∫ßm g·∫≠y"],
            ["Êñá","w√©n","VƒÉn","Ch·ªØ vi·∫øt","H√¨nh xƒÉm tr√™n ng∆∞·ªùi"], ["Êñó","d«íu","ƒê·∫©u","C√°i ƒë·∫•u","D·ª•ng c·ª• ƒëong th√≥c"],
            ["Êñ§","jƒ´n","C√¢n","C√°i r√¨u","C√°i r√¨u ch·∫∑t c√¢y"], ["Êñπ","fƒÅng","Ph∆∞∆°ng","H∆∞·ªõng","Hai thuy·ªÅn gh√©p l·∫°i"],
            ["Êó†","w√∫","V√¥","Kh√¥ng c√≥","Ng∆∞·ªùi nh·∫£y m√∫a"], ["Êó•","r√¨","Nh·∫≠t","M·∫∑t tr·ªùi","H√¨nh tr√≤n c√≥ ch·∫•m"],
            ["Êõ∞","yuƒì","Vi·∫øt","N√≥i r·∫±ng","Mi·ªáng ƒëang n√≥i"], ["Êúà","yu√®","Nguy·ªát","M·∫∑t trƒÉng","TrƒÉng khuy·∫øt"],
            ["Êú®","m√π","M·ªôc","C√¢y","Th√¢n c√¢y v√† c√†nh"], ["Ê¨†","qi√†n","Khi·∫øm","Thi·∫øu th·ªën","Ng∆∞·ªùi h√° mi·ªáng th·ªü"],
            ["Ê≠¢","zh«ê","Ch·ªâ","D·ª´ng l·∫°i","D·∫•u ch√¢n d·ª´ng"], ["Ê≠π","d«éi","ƒê√£i","X·∫•u xa","Khung x∆∞∆°ng t√†n"],
            ["ÊÆ≥","sh≈´","Th√π","Binh kh√≠","Tay c·∫ßm g·∫≠y d√†i"], ["ÊØã","w√∫","V√¥","ƒê·ª´ng","C·∫•m ƒëo√°n"],
            ["ÊØî","b«ê","T·ª∑","So s√°nh","Hai ng∆∞·ªùi ƒë·ª©ng c·∫°nh"], ["ÊØõ","m√°o","Mao","L√¥ng","L√¥ng ƒë·ªông v·∫≠t"],
            ["Ê∞è","sh√¨","Th·ªã","H·ªç","G·ªëc r·ªÖ c√¢y"], ["Ê∞î","q√¨","Kh√≠","H∆°i n∆∞·ªõc","Lu·ªìng m√¢y bay"],
            ["Ê∞¥","shu«ê","Th·ªßy","N∆∞·ªõc","D√≤ng n∆∞·ªõc ch·∫£y"], ["ÁÅ´","hu«í","H·ªèa","L·ª≠a","Ng·ªçn l·ª≠a b√πng"],
            ["Áà™","zh«éo","Tr·∫£o","M√≥ng vu·ªët","B√†n ch√¢n chim"], ["Áà∂","f√π","Ph·ª•","Cha","Tay c·∫ßm roi d·∫°y"],
            ["Áàª","y√°o","H√†o","H√†o qu·∫ª","N√©t ƒëan ch√©o"], ["Áàø","qi√°ng","T∆∞·ªùng","M·∫£nh g·ªó","C√°i gi∆∞·ªùng g·ªó"],
            ["Áâá","pi√†n","Phi·∫øn","M·∫£nh nh·ªè","N·ª≠a th√¢n c√¢y"], ["Áâô","y√°","Nha","RƒÉng","RƒÉng nanh ƒëan"],
            ["Áâõ","ni√∫","Ng∆∞u","Con tr√¢u","ƒê·∫ßu tr√¢u c√≥ s·ª´ng"], ["Áä¨","qu«én","Khuy·ªÉn","Con ch√≥","Con ch√≥ ƒë·ª©ng"]
            // H·ªá th·ªëng s·∫Ω hi·ªÉn th·ªã 100 b·ªô ti√™u bi·ªÉu nh·∫•t ƒë·ªÉ tr√°nh qu√° t·∫£i DOM, b·∫°n c√≥ th·ªÉ th√™m ti·∫øp v√†o m·∫£ng n√†y.
        ];

        // --- PINYIN DATA ---
        const sm = ["", "b", "p", "m", "f", "d", "t", "n", "l", "g", "k", "h", "j", "q", "x", "zh", "ch", "sh", "r", "z", "c", "s"];
        const vm = ["a", "o", "e", "i", "u", "√º", "ai", "ei", "ui", "ao", "ou", "iu", "ie", "√ºe", "er", "an", "en", "in", "un", "vn", "ang", "eng", "ing", "ong"];

        // --- INITIALIZATION ---
        function init() {
            // Render Radicals
            const grid = document.getElementById('radGrid');
            radData.forEach((r, i) => {
                const div = document.createElement('div');
                div.className = 'rad-item';
                div.innerHTML = `<span class="char">${r[0]}</span><span class="pinyin">${r[1]}</span>`;
                div.onclick = () => showRad(r);
                grid.appendChild(div);
            });

            // Render Pinyin Table
            const head = document.getElementById('pHead');
            const body = document.getElementById('pBody');
            head.innerHTML = '<th>SM \\ VM</th>' + vm.map(v => `<th>${v}</th>`).join('');
            
            sm.slice(1).forEach(s => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td style="font-weight:bold; background:#f8fafc;">${s}</td>` + 
                    vm.map(v => `<td class="cell" onclick="showP('${s}${v}')">${s}${v}</td>`).join('');
                body.appendChild(tr);
            });
        }

        // --- NAVIGATION ---
        function nav(id, btn) {
            document.querySelectorAll('.tool-card').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
            if(window.innerWidth <= 768) document.getElementById('sidebar').classList.remove('open');
        }

        // --- MODAL & DETAIL ---
        function showRad(r) {
            const m = document.getElementById('modal');
            document.getElementById('mChar').innerText = r[0];
            document.getElementById('mViet').innerText = "B·ªô " + r[2];
            document.getElementById('mPinyin').innerText = r[1];
            document.getElementById('mMean').innerText = "√ù nghƒ©a: " + r[3];
            document.getElementById('mDesc').innerText = "T∆∞·ª£ng h√¨nh: " + r[4];
            m.style.display = 'flex';
        }
        function closeModal() { document.getElementById('modal').style.display = 'none'; }

        function showP(p) {
            document.getElementById('pDetail').style.display = 'block';
            document.getElementById('pChar').innerText = p;
            document.getElementById('pMouth').innerText = "M·ªü r·ªông v·ª´a ph·∫£i, m√¥i th·∫£ l·ªèng.";
            document.getElementById('pTongue').innerText = "ƒê·∫∑t ·ªü v·ªã tr√≠ t·ª± nhi√™n, ƒë·∫ßu l∆∞·ª°i ch·∫°m h√†m d∆∞·ªõi.";
            window.currentP = p;
        }

        function speakPinyin() {
            const m = new SpeechSynthesisUtterance(window.currentP);
            m.lang = 'zh-CN';
            speechSynthesis.speak(m);
        }

        // --- TODO LOGIC ---
        let todos = JSON.parse(localStorage.getItem('hub_todos')) || [];
        function renderTodos() {
            const list = document.getElementById('todoList');
            list.innerHTML = todos.map((t, i) => `
                <div style="display:flex; align-items:center; background:#f8fafc; padding:12px; border-radius:15px; margin-bottom:10px; border:1px solid #e2e8f0;">
                    <input type="checkbox" ${t.d?'checked':''} onchange="toggleT(${i})" style="width:20px; margin:0">
                    <span style="flex:1; margin-left:15px; ${t.d?'text-decoration:line-through; color:#94a3b8':''}">${t.v}</span>
                    <button onclick="delT(${i})" style="background:none; color:#e11d48; padding:0">‚úï</button>
                </div>
            `).join('');
            localStorage.setItem('hub_todos', JSON.stringify(todos));
        }
        function addTodo() {
            const val = document.getElementById('todoIn').value;
            if(val) { todos.push({v: val, d: false}); document.getElementById('todoIn').value=''; renderTodos(); }
        }
        function toggleT(i) { todos[i].d = !todos[i].d; renderTodos(); }
        function delT(i) { todos.splice(i, 1); renderTodos(); }
        function exportExcel() {
            const ws = XLSX.utils.json_to_sheet(todos);
            const wb = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, ws, "Tasks");
            XLSX.writeFile(wb, "OfficeHub_Tasks.xlsx");
        }

        // --- POMODORO ---
        let timer, secs = 1500, active = false;
        function toggleTimer() {
            const btn = document.getElementById('tBtn');
            if(active) { clearInterval(timer); btn.innerText = "B·∫Øt ƒë·∫ßu"; }
            else {
                timer = setInterval(() => {
                    secs--;
                    document.getElementById('timer').innerText = `${Math.floor(secs/60)}:${(secs%60).toString().padStart(2,'0')}`;
                    if(secs <= 0) { clearInterval(timer); alert("H·∫øt gi·ªù!"); resetTimer(); }
                }, 1000);
                btn.innerText = "T·∫°m d·ª´ng";
            }
            active = !active;
        }
        function resetTimer() { clearInterval(timer); secs = 1500; document.getElementById('timer').innerText = "25:00"; active = false; document.getElementById('tBtn').innerText = "B·∫Øt ƒë·∫ßu"; }

        // --- OTHERS ---
        function saveNotes() { localStorage.setItem('hub_notes', document.getElementById('noteArea').value); }
        document.getElementById('noteArea').value = localStorage.getItem('hub_notes') || '';

        async function convert() {
            const amt = document.getElementById('curAmount').value;
            const from = document.getElementById('curFrom').value;
            const to = document.getElementById('curTo').value;
            if(!amt) return;
            const res = await fetch(`https://api.exchangerate-api.com/v4/latest/${from}`);
            const data = await res.json();
            document.getElementById('curRes').innerText = `K·∫øt qu·∫£: ${(amt * data.rates[to]).toLocaleString()} ${to}`;
        }

        window.onload = init; renderTodos();
    </script>
</body>
</html>